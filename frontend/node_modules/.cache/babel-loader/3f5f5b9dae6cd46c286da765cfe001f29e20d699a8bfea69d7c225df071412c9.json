{"ast":null,"code":"var _jsxFileName = \"/app/frontend/src/components/InstallGuide.js\",\n  _s = $RefreshSig$();\nimport React, { useState } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst GS_FILES = {\n  'Code.gs': `/**\n * RCA Reviewer - Google Docs Add-on\n * Main entry point\n */\n\nfunction onOpen(e) {\n  DocumentApp.getUi()\n    .createAddonMenu()\n    .addItem('Open RCA Reviewer', 'showSidebar')\n    .addToUi();\n}\n\nfunction onInstall(e) {\n  onOpen(e);\n}\n\nfunction showSidebar() {\n  var html = HtmlService.createHtmlOutputFromFile('Sidebar')\n    .setTitle('RCA Reviewer')\n    .setWidth(360);\n  DocumentApp.getUi().showSidebar(html);\n}\n\n/**\n * Run the RCA review analysis\n */\nfunction runReview() {\n  var doc = DocumentApp.getActiveDocument();\n  var rcaTab = findOrCreateTab(doc, 'RCA');\n  \n  if (!rcaTab) {\n    return { error: 'RCA tab not found. Please create a tab named \"RCA\" with your content.' };\n  }\n  \n  var rcaBody = rcaTab.asDocumentTab().getBody();\n  var rcaText = rcaBody.getText();\n  \n  if (!rcaText.trim()) {\n    return { error: 'RCA tab is empty. Please write your RCA content first.' };\n  }\n  \n  // Get existing issue tracking\n  var props = PropertiesService.getDocumentProperties();\n  var existingIssues = JSON.parse(props.getProperty('rca_issues') || '[]');\n  \n  // Call backend API\n  var analysis = callBackendAPI('/api/analyze-rca', {\n    document_text: rcaText,\n    existing_issues: existingIssues\n  });\n  \n  if (analysis.error) {\n    return { error: analysis.error };\n  }\n  \n  // Insert inline comments in RCA tab\n  insertComments(doc, rcaBody, analysis.comments, existingIssues);\n  \n  // Create/update RCA Review tab\n  generateReviewTab(doc, analysis);\n  \n  // Store issue tracking\n  props.setProperty('rca_issues', JSON.stringify(analysis.comments));\n  props.setProperty('last_analysis', JSON.stringify(analysis));\n  \n  return analysis;\n}\n\n/**\n * Process a reply in a comment thread\n */\nfunction processReply(threadContext, userReply, issueType, originalComment) {\n  var result = callBackendAPI('/api/process-reply', {\n    thread_context: threadContext,\n    user_reply: userReply,\n    issue_type: issueType,\n    original_comment: originalComment\n  });\n  return result;\n}\n\n/**\n * Send a chat message\n */\nfunction sendChatMessage(message) {\n  var doc = DocumentApp.getActiveDocument();\n  var rcaTab = findOrCreateTab(doc, 'RCA');\n  var rcaText = rcaTab ? rcaTab.asDocumentTab().getBody().getText() : '';\n  \n  var props = PropertiesService.getDocumentProperties();\n  var sessionId = props.getProperty('chat_session_id') || '';\n  \n  var result = callBackendAPI('/api/chat', {\n    message: message,\n    document_context: rcaText,\n    session_id: sessionId\n  });\n  \n  if (result.session_id) {\n    props.setProperty('chat_session_id', result.session_id);\n  }\n  \n  return result;\n}`,\n  'DocumentService.gs': `/**\n * Document Tab management\n */\n\nfunction findOrCreateTab(doc, tabName) {\n  var tabs = doc.getTabs();\n  for (var i = 0; i < tabs.length; i++) {\n    if (tabs[i].getTitle() === tabName) {\n      return tabs[i];\n    }\n  }\n  return null;\n}\n\nfunction getOrCreateReviewTab(doc) {\n  var tab = findOrCreateTab(doc, 'RCA Review');\n  if (!tab) {\n    tab = doc.addTab('RCA Review');\n  }\n  return tab;\n}\n\nfunction generateReviewTab(doc, analysis) {\n  var tab = getOrCreateReviewTab(doc);\n  var body = tab.asDocumentTab().getBody();\n  \n  // Clear existing content\n  body.clear();\n  \n  var es = analysis.executive_summary;\n  var totalScore = analysis.total_score;\n  var timestamp = new Date().toLocaleString();\n  \n  // Header\n  var title = body.appendParagraph('RCA Reviewer -- Executive Summary');\n  title.setHeading(DocumentApp.ParagraphHeading.HEADING1);\n  title.setForegroundColor('#1a73e8');\n  \n  var subtitle = body.appendParagraph('Auto-generated. Updated on ' + timestamp + '.');\n  subtitle.setForegroundColor('#5f6368');\n  subtitle.setFontSize(10);\n  \n  body.appendParagraph('');\n  \n  // Section 1: Overall Assessment\n  var s1 = body.appendParagraph('Section 1: Overall Assessment');\n  s1.setHeading(DocumentApp.ParagraphHeading.HEADING2);\n  \n  body.appendParagraph('RCA Quality Score: ' + totalScore + ' / 30').setBold(true);\n  body.appendParagraph(es.overall_interpretation || '');\n  body.appendParagraph('');\n  \n  // Section 2: Leadership Summary\n  var s2 = body.appendParagraph('Section 2: Leadership Summary');\n  s2.setHeading(DocumentApp.ParagraphHeading.HEADING2);\n  \n  var bullets = es.leadership_bullets || [];\n  for (var i = 0; i < Math.min(bullets.length, 5); i++) {\n    body.appendListItem(bullets[i]).setGlyphType(DocumentApp.GlyphType.BULLET);\n  }\n  body.appendParagraph('');\n  \n  // Section 3: Key Gaps Identified\n  var s3 = body.appendParagraph('Section 3: Key Gaps Identified');\n  s3.setHeading(DocumentApp.ParagraphHeading.HEADING2);\n  \n  var gaps = es.key_gaps || [];\n  for (var i = 0; i < Math.min(gaps.length, 3); i++) {\n    body.appendListItem(gaps[i]).setGlyphType(DocumentApp.GlyphType.NUMBER);\n  }\n  body.appendParagraph('');\n  \n  // Section 4: Recurrence Risk\n  var s4 = body.appendParagraph('Section 4: Recurrence Risk');\n  s4.setHeading(DocumentApp.ParagraphHeading.HEADING2);\n  \n  body.appendParagraph(es.recurrence_risk || 'N/A').setBold(true);\n  body.appendParagraph(es.recurrence_rationale || '');\n  body.appendParagraph('');\n  \n  // Section 5: Action Items Critique\n  var s5 = body.appendParagraph('Section 5: Action Items Critique');\n  s5.setHeading(DocumentApp.ParagraphHeading.HEADING2);\n  \n  body.appendParagraph(es.action_critique || '');\n  body.appendParagraph('');\n  \n  // Section 6: What to Improve Next\n  var s6 = body.appendParagraph('Section 6: What to Improve Next');\n  s6.setHeading(DocumentApp.ParagraphHeading.HEADING2);\n  \n  var improvements = es.improvements || [];\n  for (var i = 0; i < improvements.length; i++) {\n    body.appendListItem(improvements[i]).setGlyphType(DocumentApp.GlyphType.BULLET);\n  }\n}`,\n  'CommentService.gs': `/**\n * Comment management for inline feedback\n */\n\nfunction insertComments(doc, rcaBody, comments, existingIssues) {\n  var existingMap = {};\n  for (var i = 0; i < existingIssues.length; i++) {\n    existingMap[existingIssues[i].issue_id] = existingIssues[i];\n  }\n  \n  for (var i = 0; i < comments.length; i++) {\n    var comment = comments[i];\n    \n    if (comment.resolved) {\n      // If issue is resolved, optionally mark it\n      continue;\n    }\n    \n    var anchorText = comment.anchor_text;\n    if (!anchorText) continue;\n    \n    // Find the text in the document\n    var searchResult = rcaBody.findText(escapeRegex(anchorText));\n    \n    if (searchResult) {\n      var element = searchResult.getElement();\n      var start = searchResult.getStartOffset();\n      var end = searchResult.getEndOffsetInclusive();\n      \n      // Highlight the text\n      if (element.editAsText) {\n        element.editAsText().setBackgroundColor(start, end, '#fce8b2');\n      }\n      \n      // Note: Google Docs API for comments requires Drive API\n      // In Apps Script, we use document-level comments via Drive\n      addDocumentComment(doc, comment);\n    }\n  }\n}\n\nfunction addDocumentComment(doc, comment) {\n  try {\n    var docId = doc.getId();\n    \n    // Use Drive API to add comments\n    // This requires the Drive API to be enabled\n    var resource = {\n      content: comment.comment_body,\n      anchor: comment.anchor_text\n    };\n    \n    // Store comment mapping for tracking\n    var props = PropertiesService.getDocumentProperties();\n    var commentMap = JSON.parse(props.getProperty('comment_map') || '{}');\n    commentMap[comment.issue_id] = {\n      issue_type: comment.issue_type,\n      anchor_text: comment.anchor_text,\n      comment_body: comment.comment_body,\n      timestamp: new Date().toISOString()\n    };\n    props.setProperty('comment_map', JSON.stringify(commentMap));\n    \n  } catch (e) {\n    Logger.log('Error adding comment: ' + e.toString());\n  }\n}\n\nfunction escapeRegex(str) {\n  return str.replace(/[.*+?^\\${}()|[\\\\]\\\\\\\\]/g, '\\\\\\\\$&');\n}`,\n  'ApiService.gs': `/**\n * Backend API communication\n */\n\nvar API_BASE_URL = 'YOUR_BACKEND_URL_HERE'; // Replace with your deployed backend URL\n\nfunction callBackendAPI(endpoint, payload) {\n  try {\n    var options = {\n      method: 'post',\n      contentType: 'application/json',\n      payload: JSON.stringify(payload),\n      muteHttpExceptions: true,\n      headers: {\n        'Accept': 'application/json'\n      }\n    };\n    \n    var response = UrlFetchApp.fetch(API_BASE_URL + endpoint, options);\n    var code = response.getResponseCode();\n    \n    if (code === 200) {\n      return JSON.parse(response.getContentText());\n    } else {\n      Logger.log('API error: ' + code + ' - ' + response.getContentText());\n      return { error: 'API request failed with status ' + code };\n    }\n    \n  } catch (e) {\n    Logger.log('API call failed: ' + e.toString());\n    return { error: 'Failed to connect to backend: ' + e.toString() };\n  }\n}`,\n  'appsscript.json': `{\n  \"timeZone\": \"America/New_York\",\n  \"dependencies\": {\n    \"enabledAdvancedServices\": [\n      {\n        \"userSymbol\": \"Drive\",\n        \"version\": \"v3\",\n        \"serviceId\": \"drive\"\n      }\n    ]\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"oauthScopes\": [\n    \"https://www.googleapis.com/auth/documents.currentonly\",\n    \"https://www.googleapis.com/auth/drive.file\",\n    \"https://www.googleapis.com/auth/script.external_request\",\n    \"https://www.googleapis.com/auth/script.container.ui\"\n  ]\n}`\n};\nfunction InstallGuide() {\n  _s();\n  const [activeFile, setActiveFile] = useState('Code.gs');\n  const [copied, setCopied] = useState(false);\n  const copyCode = () => {\n    navigator.clipboard.writeText(GS_FILES[activeFile]);\n    setCopied(true);\n    setTimeout(() => setCopied(false), 2000);\n  };\n  const fileNames = Object.keys(GS_FILES);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"doc-area\",\n    \"data-testid\": \"install-guide\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"doc-card\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"doc-body\",\n        style: {\n          maxWidth: 800\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          style: {\n            marginBottom: 8\n          },\n          children: \"Installation Guide\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 350,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            color: 'var(--google-grey-500)',\n            marginBottom: 32\n          },\n          children: \"Set up the RCA Reviewer add-on in your Google Docs\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 351,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"guide-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n              width: \"20\",\n              height: \"20\",\n              viewBox: \"0 0 24 24\",\n              fill: \"none\",\n              stroke: \"var(--google-blue)\",\n              strokeWidth: \"2\",\n              children: [/*#__PURE__*/_jsxDEV(\"circle\", {\n                cx: \"12\",\n                cy: \"12\",\n                r: \"10\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 358,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n                d: \"M12 6v6l4 2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 358,\n                columnNumber: 49\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 357,\n              columnNumber: 15\n            }, this), \"Setup Steps\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 356,\n            columnNumber: 13\n          }, this), [{\n            num: 1,\n            text: 'Open your Google Doc and go to Extensions > Apps Script'\n          }, {\n            num: 2,\n            text: 'Delete the default Code.gs content and replace with the code below'\n          }, {\n            num: 3,\n            text: 'Create additional .gs files for each service (DocumentService, CommentService, ApiService)'\n          }, {\n            num: 4,\n            text: 'Create a Sidebar.html file using the HTML template below'\n          }, {\n            num: 5,\n            text: 'Update API_BASE_URL in ApiService.gs with your deployed backend URL'\n          }, {\n            num: 6,\n            text: 'Update appsscript.json with the manifest content provided'\n          }, {\n            num: 7,\n            text: 'Save and reload the Google Doc. The add-on will appear under Extensions menu.'\n          }].map(step => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"guide-step\",\n            \"data-testid\": `guide-step-${step.num}`,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"guide-step-num\",\n              children: step.num\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 373,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"guide-step-content\",\n              children: step.text\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 374,\n              columnNumber: 17\n            }, this)]\n          }, step.num, true, {\n            fileName: _jsxFileName,\n            lineNumber: 372,\n            columnNumber: 15\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 355,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"guide-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n              width: \"20\",\n              height: \"20\",\n              viewBox: \"0 0 24 24\",\n              fill: \"none\",\n              stroke: \"var(--google-blue)\",\n              strokeWidth: \"2\",\n              children: [/*#__PURE__*/_jsxDEV(\"polyline\", {\n                points: \"16 18 22 12 16 6\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 382,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"polyline\", {\n                points: \"8 6 2 12 8 18\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 382,\n                columnNumber: 54\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 381,\n              columnNumber: 15\n            }, this), \"Add-on Source Code\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 380,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: 'flex',\n              gap: 8,\n              flexWrap: 'wrap',\n              marginBottom: 16\n            },\n            children: fileNames.map(name => /*#__PURE__*/_jsxDEV(\"button\", {\n              className: `topbar-nav-btn ${activeFile === name ? 'active' : ''}`,\n              onClick: () => setActiveFile(name),\n              \"data-testid\": `code-file-btn-${name.replace('.', '-')}`,\n              children: name\n            }, name, false, {\n              fileName: _jsxFileName,\n              lineNumber: 389,\n              columnNumber: 17\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 387,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"code-block\",\n            \"data-testid\": \"code-block\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"code-block-header\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"code-block-filename\",\n                children: activeFile\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 402,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"code-copy-btn\",\n                onClick: copyCode,\n                \"data-testid\": \"copy-code-btn\",\n                children: copied ? 'Copied!' : 'Copy'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 403,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 401,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"pre\", {\n              style: {\n                margin: 0,\n                whiteSpace: 'pre-wrap',\n                wordBreak: 'break-word'\n              },\n              children: GS_FILES[activeFile]\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 407,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 400,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 379,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"guide-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n              width: \"20\",\n              height: \"20\",\n              viewBox: \"0 0 24 24\",\n              fill: \"none\",\n              stroke: \"var(--google-blue)\",\n              strokeWidth: \"2\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                d: \"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 416,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 415,\n              columnNumber: 15\n            }, this), \"Backend Deployment\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 414,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            style: {\n              fontSize: 14,\n              color: 'var(--google-grey-700)',\n              lineHeight: 1.6\n            },\n            children: [\"The backend API needs to be deployed and accessible from Google Apps Script. Update the \", /*#__PURE__*/_jsxDEV(\"code\", {\n              children: \"API_BASE_URL\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 422,\n              columnNumber: 26\n            }, this), \" in \", /*#__PURE__*/_jsxDEV(\"code\", {\n              children: \"ApiService.gs\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 422,\n              columnNumber: 55\n            }, this), \" with your backend URL. The API handles RCA analysis using OpenAI GPT-4o and stores chat history in MongoDB.\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 420,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 413,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 349,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 348,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 347,\n    columnNumber: 5\n  }, this);\n}\n_s(InstallGuide, \"HsyveByKgTQFLfRUhVQNgaIa60s=\");\n_c = InstallGuide;\nexport default InstallGuide;\nvar _c;\n$RefreshReg$(_c, \"InstallGuide\");","map":{"version":3,"names":["React","useState","jsxDEV","_jsxDEV","GS_FILES","InstallGuide","_s","activeFile","setActiveFile","copied","setCopied","copyCode","navigator","clipboard","writeText","setTimeout","fileNames","Object","keys","className","children","style","maxWidth","marginBottom","fileName","_jsxFileName","lineNumber","columnNumber","color","width","height","viewBox","fill","stroke","strokeWidth","cx","cy","r","d","num","text","map","step","points","display","gap","flexWrap","name","onClick","replace","margin","whiteSpace","wordBreak","fontSize","lineHeight","_c","$RefreshReg$"],"sources":["/app/frontend/src/components/InstallGuide.js"],"sourcesContent":["import React, { useState } from 'react';\n\nconst GS_FILES = {\n  'Code.gs': `/**\n * RCA Reviewer - Google Docs Add-on\n * Main entry point\n */\n\nfunction onOpen(e) {\n  DocumentApp.getUi()\n    .createAddonMenu()\n    .addItem('Open RCA Reviewer', 'showSidebar')\n    .addToUi();\n}\n\nfunction onInstall(e) {\n  onOpen(e);\n}\n\nfunction showSidebar() {\n  var html = HtmlService.createHtmlOutputFromFile('Sidebar')\n    .setTitle('RCA Reviewer')\n    .setWidth(360);\n  DocumentApp.getUi().showSidebar(html);\n}\n\n/**\n * Run the RCA review analysis\n */\nfunction runReview() {\n  var doc = DocumentApp.getActiveDocument();\n  var rcaTab = findOrCreateTab(doc, 'RCA');\n  \n  if (!rcaTab) {\n    return { error: 'RCA tab not found. Please create a tab named \"RCA\" with your content.' };\n  }\n  \n  var rcaBody = rcaTab.asDocumentTab().getBody();\n  var rcaText = rcaBody.getText();\n  \n  if (!rcaText.trim()) {\n    return { error: 'RCA tab is empty. Please write your RCA content first.' };\n  }\n  \n  // Get existing issue tracking\n  var props = PropertiesService.getDocumentProperties();\n  var existingIssues = JSON.parse(props.getProperty('rca_issues') || '[]');\n  \n  // Call backend API\n  var analysis = callBackendAPI('/api/analyze-rca', {\n    document_text: rcaText,\n    existing_issues: existingIssues\n  });\n  \n  if (analysis.error) {\n    return { error: analysis.error };\n  }\n  \n  // Insert inline comments in RCA tab\n  insertComments(doc, rcaBody, analysis.comments, existingIssues);\n  \n  // Create/update RCA Review tab\n  generateReviewTab(doc, analysis);\n  \n  // Store issue tracking\n  props.setProperty('rca_issues', JSON.stringify(analysis.comments));\n  props.setProperty('last_analysis', JSON.stringify(analysis));\n  \n  return analysis;\n}\n\n/**\n * Process a reply in a comment thread\n */\nfunction processReply(threadContext, userReply, issueType, originalComment) {\n  var result = callBackendAPI('/api/process-reply', {\n    thread_context: threadContext,\n    user_reply: userReply,\n    issue_type: issueType,\n    original_comment: originalComment\n  });\n  return result;\n}\n\n/**\n * Send a chat message\n */\nfunction sendChatMessage(message) {\n  var doc = DocumentApp.getActiveDocument();\n  var rcaTab = findOrCreateTab(doc, 'RCA');\n  var rcaText = rcaTab ? rcaTab.asDocumentTab().getBody().getText() : '';\n  \n  var props = PropertiesService.getDocumentProperties();\n  var sessionId = props.getProperty('chat_session_id') || '';\n  \n  var result = callBackendAPI('/api/chat', {\n    message: message,\n    document_context: rcaText,\n    session_id: sessionId\n  });\n  \n  if (result.session_id) {\n    props.setProperty('chat_session_id', result.session_id);\n  }\n  \n  return result;\n}`,\n\n  'DocumentService.gs': `/**\n * Document Tab management\n */\n\nfunction findOrCreateTab(doc, tabName) {\n  var tabs = doc.getTabs();\n  for (var i = 0; i < tabs.length; i++) {\n    if (tabs[i].getTitle() === tabName) {\n      return tabs[i];\n    }\n  }\n  return null;\n}\n\nfunction getOrCreateReviewTab(doc) {\n  var tab = findOrCreateTab(doc, 'RCA Review');\n  if (!tab) {\n    tab = doc.addTab('RCA Review');\n  }\n  return tab;\n}\n\nfunction generateReviewTab(doc, analysis) {\n  var tab = getOrCreateReviewTab(doc);\n  var body = tab.asDocumentTab().getBody();\n  \n  // Clear existing content\n  body.clear();\n  \n  var es = analysis.executive_summary;\n  var totalScore = analysis.total_score;\n  var timestamp = new Date().toLocaleString();\n  \n  // Header\n  var title = body.appendParagraph('RCA Reviewer -- Executive Summary');\n  title.setHeading(DocumentApp.ParagraphHeading.HEADING1);\n  title.setForegroundColor('#1a73e8');\n  \n  var subtitle = body.appendParagraph('Auto-generated. Updated on ' + timestamp + '.');\n  subtitle.setForegroundColor('#5f6368');\n  subtitle.setFontSize(10);\n  \n  body.appendParagraph('');\n  \n  // Section 1: Overall Assessment\n  var s1 = body.appendParagraph('Section 1: Overall Assessment');\n  s1.setHeading(DocumentApp.ParagraphHeading.HEADING2);\n  \n  body.appendParagraph('RCA Quality Score: ' + totalScore + ' / 30').setBold(true);\n  body.appendParagraph(es.overall_interpretation || '');\n  body.appendParagraph('');\n  \n  // Section 2: Leadership Summary\n  var s2 = body.appendParagraph('Section 2: Leadership Summary');\n  s2.setHeading(DocumentApp.ParagraphHeading.HEADING2);\n  \n  var bullets = es.leadership_bullets || [];\n  for (var i = 0; i < Math.min(bullets.length, 5); i++) {\n    body.appendListItem(bullets[i]).setGlyphType(DocumentApp.GlyphType.BULLET);\n  }\n  body.appendParagraph('');\n  \n  // Section 3: Key Gaps Identified\n  var s3 = body.appendParagraph('Section 3: Key Gaps Identified');\n  s3.setHeading(DocumentApp.ParagraphHeading.HEADING2);\n  \n  var gaps = es.key_gaps || [];\n  for (var i = 0; i < Math.min(gaps.length, 3); i++) {\n    body.appendListItem(gaps[i]).setGlyphType(DocumentApp.GlyphType.NUMBER);\n  }\n  body.appendParagraph('');\n  \n  // Section 4: Recurrence Risk\n  var s4 = body.appendParagraph('Section 4: Recurrence Risk');\n  s4.setHeading(DocumentApp.ParagraphHeading.HEADING2);\n  \n  body.appendParagraph(es.recurrence_risk || 'N/A').setBold(true);\n  body.appendParagraph(es.recurrence_rationale || '');\n  body.appendParagraph('');\n  \n  // Section 5: Action Items Critique\n  var s5 = body.appendParagraph('Section 5: Action Items Critique');\n  s5.setHeading(DocumentApp.ParagraphHeading.HEADING2);\n  \n  body.appendParagraph(es.action_critique || '');\n  body.appendParagraph('');\n  \n  // Section 6: What to Improve Next\n  var s6 = body.appendParagraph('Section 6: What to Improve Next');\n  s6.setHeading(DocumentApp.ParagraphHeading.HEADING2);\n  \n  var improvements = es.improvements || [];\n  for (var i = 0; i < improvements.length; i++) {\n    body.appendListItem(improvements[i]).setGlyphType(DocumentApp.GlyphType.BULLET);\n  }\n}`,\n\n  'CommentService.gs': `/**\n * Comment management for inline feedback\n */\n\nfunction insertComments(doc, rcaBody, comments, existingIssues) {\n  var existingMap = {};\n  for (var i = 0; i < existingIssues.length; i++) {\n    existingMap[existingIssues[i].issue_id] = existingIssues[i];\n  }\n  \n  for (var i = 0; i < comments.length; i++) {\n    var comment = comments[i];\n    \n    if (comment.resolved) {\n      // If issue is resolved, optionally mark it\n      continue;\n    }\n    \n    var anchorText = comment.anchor_text;\n    if (!anchorText) continue;\n    \n    // Find the text in the document\n    var searchResult = rcaBody.findText(escapeRegex(anchorText));\n    \n    if (searchResult) {\n      var element = searchResult.getElement();\n      var start = searchResult.getStartOffset();\n      var end = searchResult.getEndOffsetInclusive();\n      \n      // Highlight the text\n      if (element.editAsText) {\n        element.editAsText().setBackgroundColor(start, end, '#fce8b2');\n      }\n      \n      // Note: Google Docs API for comments requires Drive API\n      // In Apps Script, we use document-level comments via Drive\n      addDocumentComment(doc, comment);\n    }\n  }\n}\n\nfunction addDocumentComment(doc, comment) {\n  try {\n    var docId = doc.getId();\n    \n    // Use Drive API to add comments\n    // This requires the Drive API to be enabled\n    var resource = {\n      content: comment.comment_body,\n      anchor: comment.anchor_text\n    };\n    \n    // Store comment mapping for tracking\n    var props = PropertiesService.getDocumentProperties();\n    var commentMap = JSON.parse(props.getProperty('comment_map') || '{}');\n    commentMap[comment.issue_id] = {\n      issue_type: comment.issue_type,\n      anchor_text: comment.anchor_text,\n      comment_body: comment.comment_body,\n      timestamp: new Date().toISOString()\n    };\n    props.setProperty('comment_map', JSON.stringify(commentMap));\n    \n  } catch (e) {\n    Logger.log('Error adding comment: ' + e.toString());\n  }\n}\n\nfunction escapeRegex(str) {\n  return str.replace(/[.*+?^\\${}()|[\\\\]\\\\\\\\]/g, '\\\\\\\\$&');\n}`,\n\n  'ApiService.gs': `/**\n * Backend API communication\n */\n\nvar API_BASE_URL = 'YOUR_BACKEND_URL_HERE'; // Replace with your deployed backend URL\n\nfunction callBackendAPI(endpoint, payload) {\n  try {\n    var options = {\n      method: 'post',\n      contentType: 'application/json',\n      payload: JSON.stringify(payload),\n      muteHttpExceptions: true,\n      headers: {\n        'Accept': 'application/json'\n      }\n    };\n    \n    var response = UrlFetchApp.fetch(API_BASE_URL + endpoint, options);\n    var code = response.getResponseCode();\n    \n    if (code === 200) {\n      return JSON.parse(response.getContentText());\n    } else {\n      Logger.log('API error: ' + code + ' - ' + response.getContentText());\n      return { error: 'API request failed with status ' + code };\n    }\n    \n  } catch (e) {\n    Logger.log('API call failed: ' + e.toString());\n    return { error: 'Failed to connect to backend: ' + e.toString() };\n  }\n}`,\n\n  'appsscript.json': `{\n  \"timeZone\": \"America/New_York\",\n  \"dependencies\": {\n    \"enabledAdvancedServices\": [\n      {\n        \"userSymbol\": \"Drive\",\n        \"version\": \"v3\",\n        \"serviceId\": \"drive\"\n      }\n    ]\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"oauthScopes\": [\n    \"https://www.googleapis.com/auth/documents.currentonly\",\n    \"https://www.googleapis.com/auth/drive.file\",\n    \"https://www.googleapis.com/auth/script.external_request\",\n    \"https://www.googleapis.com/auth/script.container.ui\"\n  ]\n}`\n};\n\nfunction InstallGuide() {\n  const [activeFile, setActiveFile] = useState('Code.gs');\n  const [copied, setCopied] = useState(false);\n\n  const copyCode = () => {\n    navigator.clipboard.writeText(GS_FILES[activeFile]);\n    setCopied(true);\n    setTimeout(() => setCopied(false), 2000);\n  };\n\n  const fileNames = Object.keys(GS_FILES);\n\n  return (\n    <div className=\"doc-area\" data-testid=\"install-guide\">\n      <div className=\"doc-card\">\n        <div className=\"doc-body\" style={{ maxWidth: 800 }}>\n          <h2 style={{ marginBottom: 8 }}>Installation Guide</h2>\n          <p style={{ color: 'var(--google-grey-500)', marginBottom: 32 }}>\n            Set up the RCA Reviewer add-on in your Google Docs\n          </p>\n\n          <div className=\"guide-section\">\n            <h3>\n              <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"var(--google-blue)\" strokeWidth=\"2\">\n                <circle cx=\"12\" cy=\"12\" r=\"10\"/><path d=\"M12 6v6l4 2\"/>\n              </svg>\n              Setup Steps\n            </h3>\n\n            {[\n              { num: 1, text: 'Open your Google Doc and go to Extensions > Apps Script' },\n              { num: 2, text: 'Delete the default Code.gs content and replace with the code below' },\n              { num: 3, text: 'Create additional .gs files for each service (DocumentService, CommentService, ApiService)' },\n              { num: 4, text: 'Create a Sidebar.html file using the HTML template below' },\n              { num: 5, text: 'Update API_BASE_URL in ApiService.gs with your deployed backend URL' },\n              { num: 6, text: 'Update appsscript.json with the manifest content provided' },\n              { num: 7, text: 'Save and reload the Google Doc. The add-on will appear under Extensions menu.' },\n            ].map(step => (\n              <div key={step.num} className=\"guide-step\" data-testid={`guide-step-${step.num}`}>\n                <div className=\"guide-step-num\">{step.num}</div>\n                <div className=\"guide-step-content\">{step.text}</div>\n              </div>\n            ))}\n          </div>\n\n          <div className=\"guide-section\">\n            <h3>\n              <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"var(--google-blue)\" strokeWidth=\"2\">\n                <polyline points=\"16 18 22 12 16 6\"/><polyline points=\"8 6 2 12 8 18\"/>\n              </svg>\n              Add-on Source Code\n            </h3>\n\n            <div style={{ display: 'flex', gap: 8, flexWrap: 'wrap', marginBottom: 16 }}>\n              {fileNames.map(name => (\n                <button\n                  key={name}\n                  className={`topbar-nav-btn ${activeFile === name ? 'active' : ''}`}\n                  onClick={() => setActiveFile(name)}\n                  data-testid={`code-file-btn-${name.replace('.', '-')}`}\n                >\n                  {name}\n                </button>\n              ))}\n            </div>\n\n            <div className=\"code-block\" data-testid=\"code-block\">\n              <div className=\"code-block-header\">\n                <span className=\"code-block-filename\">{activeFile}</span>\n                <button className=\"code-copy-btn\" onClick={copyCode} data-testid=\"copy-code-btn\">\n                  {copied ? 'Copied!' : 'Copy'}\n                </button>\n              </div>\n              <pre style={{ margin: 0, whiteSpace: 'pre-wrap', wordBreak: 'break-word' }}>\n                {GS_FILES[activeFile]}\n              </pre>\n            </div>\n          </div>\n\n          <div className=\"guide-section\">\n            <h3>\n              <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"var(--google-blue)\" strokeWidth=\"2\">\n                <path d=\"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z\"/>\n              </svg>\n              Backend Deployment\n            </h3>\n            <p style={{ fontSize: 14, color: 'var(--google-grey-700)', lineHeight: 1.6 }}>\n              The backend API needs to be deployed and accessible from Google Apps Script. \n              Update the <code>API_BASE_URL</code> in <code>ApiService.gs</code> with your backend URL.\n              The API handles RCA analysis using OpenAI GPT-4o and stores chat history in MongoDB.\n            </p>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default InstallGuide;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,QAAQ,OAAO;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAExC,MAAMC,QAAQ,GAAG;EACf,SAAS,EAAE;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;EAEA,oBAAoB,EAAE;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;EAEA,mBAAmB,EAAE;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;EAEA,eAAe,EAAE;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;EAEA,iBAAiB,EAAE;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAED,SAASC,YAAYA,CAAA,EAAG;EAAAC,EAAA;EACtB,MAAM,CAACC,UAAU,EAAEC,aAAa,CAAC,GAAGP,QAAQ,CAAC,SAAS,CAAC;EACvD,MAAM,CAACQ,MAAM,EAAEC,SAAS,CAAC,GAAGT,QAAQ,CAAC,KAAK,CAAC;EAE3C,MAAMU,QAAQ,GAAGA,CAAA,KAAM;IACrBC,SAAS,CAACC,SAAS,CAACC,SAAS,CAACV,QAAQ,CAACG,UAAU,CAAC,CAAC;IACnDG,SAAS,CAAC,IAAI,CAAC;IACfK,UAAU,CAAC,MAAML,SAAS,CAAC,KAAK,CAAC,EAAE,IAAI,CAAC;EAC1C,CAAC;EAED,MAAMM,SAAS,GAAGC,MAAM,CAACC,IAAI,CAACd,QAAQ,CAAC;EAEvC,oBACED,OAAA;IAAKgB,SAAS,EAAC,UAAU;IAAC,eAAY,eAAe;IAAAC,QAAA,eACnDjB,OAAA;MAAKgB,SAAS,EAAC,UAAU;MAAAC,QAAA,eACvBjB,OAAA;QAAKgB,SAAS,EAAC,UAAU;QAACE,KAAK,EAAE;UAAEC,QAAQ,EAAE;QAAI,CAAE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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}