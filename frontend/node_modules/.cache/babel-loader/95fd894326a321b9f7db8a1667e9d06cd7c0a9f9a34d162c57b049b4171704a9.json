{"ast":null,"code":"import React,{useState}from'react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const GS_FILES={'Code.gs':\"/**\\n * RCA Reviewer - Google Docs Add-on\\n * Main entry point\\n */\\n\\nfunction onOpen(e) {\\n  DocumentApp.getUi()\\n    .createAddonMenu()\\n    .addItem('Open RCA Reviewer', 'showSidebar')\\n    .addToUi();\\n}\\n\\nfunction onInstall(e) {\\n  onOpen(e);\\n}\\n\\nfunction showSidebar() {\\n  var html = HtmlService.createHtmlOutputFromFile('Sidebar')\\n    .setTitle('RCA Reviewer')\\n    .setWidth(360);\\n  DocumentApp.getUi().showSidebar(html);\\n}\\n\\n/**\\n * Run the RCA review analysis\\n */\\nfunction runReview() {\\n  var doc = DocumentApp.getActiveDocument();\\n  var rcaTab = findOrCreateTab(doc, 'RCA');\\n  \\n  if (!rcaTab) {\\n    return { error: 'RCA tab not found. Please create a tab named \\\"RCA\\\" with your content.' };\\n  }\\n  \\n  var rcaBody = rcaTab.asDocumentTab().getBody();\\n  var rcaText = rcaBody.getText();\\n  \\n  if (!rcaText.trim()) {\\n    return { error: 'RCA tab is empty. Please write your RCA content first.' };\\n  }\\n  \\n  // Get existing issue tracking\\n  var props = PropertiesService.getDocumentProperties();\\n  var existingIssues = JSON.parse(props.getProperty('rca_issues') || '[]');\\n  \\n  // Call backend API\\n  var analysis = callBackendAPI('/api/analyze-rca', {\\n    document_text: rcaText,\\n    existing_issues: existingIssues\\n  });\\n  \\n  if (analysis.error) {\\n    return { error: analysis.error };\\n  }\\n  \\n  // Insert inline comments in RCA tab\\n  insertComments(doc, rcaBody, analysis.comments, existingIssues);\\n  \\n  // Create/update RCA Review tab\\n  generateReviewTab(doc, analysis);\\n  \\n  // Store issue tracking\\n  props.setProperty('rca_issues', JSON.stringify(analysis.comments));\\n  props.setProperty('last_analysis', JSON.stringify(analysis));\\n  \\n  return analysis;\\n}\\n\\n/**\\n * Process a reply in a comment thread\\n */\\nfunction processReply(threadContext, userReply, issueType, originalComment) {\\n  var result = callBackendAPI('/api/process-reply', {\\n    thread_context: threadContext,\\n    user_reply: userReply,\\n    issue_type: issueType,\\n    original_comment: originalComment\\n  });\\n  return result;\\n}\\n\\n/**\\n * Send a chat message\\n */\\nfunction sendChatMessage(message) {\\n  var doc = DocumentApp.getActiveDocument();\\n  var rcaTab = findOrCreateTab(doc, 'RCA');\\n  var rcaText = rcaTab ? rcaTab.asDocumentTab().getBody().getText() : '';\\n  \\n  var props = PropertiesService.getDocumentProperties();\\n  var sessionId = props.getProperty('chat_session_id') || '';\\n  \\n  var result = callBackendAPI('/api/chat', {\\n    message: message,\\n    document_context: rcaText,\\n    session_id: sessionId\\n  });\\n  \\n  if (result.session_id) {\\n    props.setProperty('chat_session_id', result.session_id);\\n  }\\n  \\n  return result;\\n}\",'DocumentService.gs':\"/**\\n * Document Tab management\\n */\\n\\nfunction findOrCreateTab(doc, tabName) {\\n  var tabs = doc.getTabs();\\n  for (var i = 0; i < tabs.length; i++) {\\n    if (tabs[i].getTitle() === tabName) {\\n      return tabs[i];\\n    }\\n  }\\n  return null;\\n}\\n\\nfunction getOrCreateReviewTab(doc) {\\n  var tab = findOrCreateTab(doc, 'RCA Review');\\n  if (!tab) {\\n    tab = doc.addTab('RCA Review');\\n  }\\n  return tab;\\n}\\n\\nfunction generateReviewTab(doc, analysis) {\\n  var tab = getOrCreateReviewTab(doc);\\n  var body = tab.asDocumentTab().getBody();\\n  \\n  // Clear existing content\\n  body.clear();\\n  \\n  var es = analysis.executive_summary;\\n  var totalScore = analysis.total_score;\\n  var timestamp = new Date().toLocaleString();\\n  \\n  // Header\\n  var title = body.appendParagraph('RCA Reviewer -- Executive Summary');\\n  title.setHeading(DocumentApp.ParagraphHeading.HEADING1);\\n  title.setForegroundColor('#1a73e8');\\n  \\n  var subtitle = body.appendParagraph('Auto-generated. Updated on ' + timestamp + '.');\\n  subtitle.setForegroundColor('#5f6368');\\n  subtitle.setFontSize(10);\\n  \\n  body.appendParagraph('');\\n  \\n  // Section 1: Overall Assessment\\n  var s1 = body.appendParagraph('Section 1: Overall Assessment');\\n  s1.setHeading(DocumentApp.ParagraphHeading.HEADING2);\\n  \\n  body.appendParagraph('RCA Quality Score: ' + totalScore + ' / 30').setBold(true);\\n  body.appendParagraph(es.overall_interpretation || '');\\n  body.appendParagraph('');\\n  \\n  // Section 2: Leadership Summary\\n  var s2 = body.appendParagraph('Section 2: Leadership Summary');\\n  s2.setHeading(DocumentApp.ParagraphHeading.HEADING2);\\n  \\n  var bullets = es.leadership_bullets || [];\\n  for (var i = 0; i < Math.min(bullets.length, 5); i++) {\\n    body.appendListItem(bullets[i]).setGlyphType(DocumentApp.GlyphType.BULLET);\\n  }\\n  body.appendParagraph('');\\n  \\n  // Section 3: Key Gaps Identified\\n  var s3 = body.appendParagraph('Section 3: Key Gaps Identified');\\n  s3.setHeading(DocumentApp.ParagraphHeading.HEADING2);\\n  \\n  var gaps = es.key_gaps || [];\\n  for (var i = 0; i < Math.min(gaps.length, 3); i++) {\\n    body.appendListItem(gaps[i]).setGlyphType(DocumentApp.GlyphType.NUMBER);\\n  }\\n  body.appendParagraph('');\\n  \\n  // Section 4: Recurrence Risk\\n  var s4 = body.appendParagraph('Section 4: Recurrence Risk');\\n  s4.setHeading(DocumentApp.ParagraphHeading.HEADING2);\\n  \\n  body.appendParagraph(es.recurrence_risk || 'N/A').setBold(true);\\n  body.appendParagraph(es.recurrence_rationale || '');\\n  body.appendParagraph('');\\n  \\n  // Section 5: Action Items Critique\\n  var s5 = body.appendParagraph('Section 5: Action Items Critique');\\n  s5.setHeading(DocumentApp.ParagraphHeading.HEADING2);\\n  \\n  body.appendParagraph(es.action_critique || '');\\n  body.appendParagraph('');\\n  \\n  // Section 6: What to Improve Next\\n  var s6 = body.appendParagraph('Section 6: What to Improve Next');\\n  s6.setHeading(DocumentApp.ParagraphHeading.HEADING2);\\n  \\n  var improvements = es.improvements || [];\\n  for (var i = 0; i < improvements.length; i++) {\\n    body.appendListItem(improvements[i]).setGlyphType(DocumentApp.GlyphType.BULLET);\\n  }\\n}\",'CommentService.gs':\"/**\\n * Comment management for inline feedback\\n */\\n\\nfunction insertComments(doc, rcaBody, comments, existingIssues) {\\n  var existingMap = {};\\n  for (var i = 0; i < existingIssues.length; i++) {\\n    existingMap[existingIssues[i].issue_id] = existingIssues[i];\\n  }\\n  \\n  for (var i = 0; i < comments.length; i++) {\\n    var comment = comments[i];\\n    \\n    if (comment.resolved) {\\n      // If issue is resolved, optionally mark it\\n      continue;\\n    }\\n    \\n    var anchorText = comment.anchor_text;\\n    if (!anchorText) continue;\\n    \\n    // Find the text in the document\\n    var searchResult = rcaBody.findText(escapeRegex(anchorText));\\n    \\n    if (searchResult) {\\n      var element = searchResult.getElement();\\n      var start = searchResult.getStartOffset();\\n      var end = searchResult.getEndOffsetInclusive();\\n      \\n      // Highlight the text\\n      if (element.editAsText) {\\n        element.editAsText().setBackgroundColor(start, end, '#fce8b2');\\n      }\\n      \\n      // Note: Google Docs API for comments requires Drive API\\n      // In Apps Script, we use document-level comments via Drive\\n      addDocumentComment(doc, comment);\\n    }\\n  }\\n}\\n\\nfunction addDocumentComment(doc, comment) {\\n  try {\\n    var docId = doc.getId();\\n    \\n    // Use Drive API to add comments\\n    // This requires the Drive API to be enabled\\n    var resource = {\\n      content: comment.comment_body,\\n      anchor: comment.anchor_text\\n    };\\n    \\n    // Store comment mapping for tracking\\n    var props = PropertiesService.getDocumentProperties();\\n    var commentMap = JSON.parse(props.getProperty('comment_map') || '{}');\\n    commentMap[comment.issue_id] = {\\n      issue_type: comment.issue_type,\\n      anchor_text: comment.anchor_text,\\n      comment_body: comment.comment_body,\\n      timestamp: new Date().toISOString()\\n    };\\n    props.setProperty('comment_map', JSON.stringify(commentMap));\\n    \\n  } catch (e) {\\n    Logger.log('Error adding comment: ' + e.toString());\\n  }\\n}\\n\\nfunction escapeRegex(str) {\\n  return str.replace(/[.*+?^${}()|[\\\\]\\\\\\\\]/g, '\\\\\\\\$&');\\n}\",'ApiService.gs':\"/**\\n * Backend API communication\\n */\\n\\nvar API_BASE_URL = 'YOUR_BACKEND_URL_HERE'; // Replace with your deployed backend URL\\n\\nfunction callBackendAPI(endpoint, payload) {\\n  try {\\n    var options = {\\n      method: 'post',\\n      contentType: 'application/json',\\n      payload: JSON.stringify(payload),\\n      muteHttpExceptions: true,\\n      headers: {\\n        'Accept': 'application/json'\\n      }\\n    };\\n    \\n    var response = UrlFetchApp.fetch(API_BASE_URL + endpoint, options);\\n    var code = response.getResponseCode();\\n    \\n    if (code === 200) {\\n      return JSON.parse(response.getContentText());\\n    } else {\\n      Logger.log('API error: ' + code + ' - ' + response.getContentText());\\n      return { error: 'API request failed with status ' + code };\\n    }\\n    \\n  } catch (e) {\\n    Logger.log('API call failed: ' + e.toString());\\n    return { error: 'Failed to connect to backend: ' + e.toString() };\\n  }\\n}\",'appsscript.json':\"{\\n  \\\"timeZone\\\": \\\"America/New_York\\\",\\n  \\\"dependencies\\\": {\\n    \\\"enabledAdvancedServices\\\": [\\n      {\\n        \\\"userSymbol\\\": \\\"Drive\\\",\\n        \\\"version\\\": \\\"v3\\\",\\n        \\\"serviceId\\\": \\\"drive\\\"\\n      }\\n    ]\\n  },\\n  \\\"exceptionLogging\\\": \\\"STACKDRIVER\\\",\\n  \\\"runtimeVersion\\\": \\\"V8\\\",\\n  \\\"oauthScopes\\\": [\\n    \\\"https://www.googleapis.com/auth/documents.currentonly\\\",\\n    \\\"https://www.googleapis.com/auth/drive.file\\\",\\n    \\\"https://www.googleapis.com/auth/script.external_request\\\",\\n    \\\"https://www.googleapis.com/auth/script.container.ui\\\"\\n  ]\\n}\"};function InstallGuide(){const[activeFile,setActiveFile]=useState('Code.gs');const[copied,setCopied]=useState(false);const copyCode=()=>{try{const textarea=document.createElement('textarea');textarea.value=GS_FILES[activeFile];textarea.style.position='fixed';textarea.style.opacity='0';document.body.appendChild(textarea);textarea.select();document.execCommand('copy');document.body.removeChild(textarea);setCopied(true);setTimeout(()=>setCopied(false),2000);}catch(e){try{navigator.clipboard.writeText(GS_FILES[activeFile]).then(()=>{setCopied(true);setTimeout(()=>setCopied(false),2000);});}catch(err){console.warn('Copy failed:',err);}}};const fileNames=Object.keys(GS_FILES);return/*#__PURE__*/_jsx(\"div\",{className:\"doc-area\",\"data-testid\":\"install-guide\",children:/*#__PURE__*/_jsx(\"div\",{className:\"doc-card\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"doc-body\",style:{maxWidth:800},children:[/*#__PURE__*/_jsx(\"h2\",{style:{marginBottom:8},children:\"Installation Guide\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'var(--google-grey-500)',marginBottom:32},children:\"Set up the RCA Reviewer add-on in your Google Docs\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"guide-section\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[/*#__PURE__*/_jsxs(\"svg\",{width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"var(--google-blue)\",strokeWidth:\"2\",children:[/*#__PURE__*/_jsx(\"circle\",{cx:\"12\",cy:\"12\",r:\"10\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M12 6v6l4 2\"})]}),\"Setup Steps\"]}),[{num:1,text:'Open your Google Doc and go to Extensions > Apps Script'},{num:2,text:'Delete the default Code.gs content and replace with the code below'},{num:3,text:'Create additional .gs files for each service (DocumentService, CommentService, ApiService)'},{num:4,text:'Create a Sidebar.html file using the HTML template below'},{num:5,text:'Update API_BASE_URL in ApiService.gs with your deployed backend URL'},{num:6,text:'Update appsscript.json with the manifest content provided'},{num:7,text:'Save and reload the Google Doc. The add-on will appear under Extensions menu.'}].map(step=>/*#__PURE__*/_jsxs(\"div\",{className:\"guide-step\",\"data-testid\":\"guide-step-\".concat(step.num),children:[/*#__PURE__*/_jsx(\"div\",{className:\"guide-step-num\",children:step.num}),/*#__PURE__*/_jsx(\"div\",{className:\"guide-step-content\",children:step.text})]},step.num))]}),/*#__PURE__*/_jsxs(\"div\",{className:\"guide-section\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[/*#__PURE__*/_jsxs(\"svg\",{width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"var(--google-blue)\",strokeWidth:\"2\",children:[/*#__PURE__*/_jsx(\"polyline\",{points:\"16 18 22 12 16 6\"}),/*#__PURE__*/_jsx(\"polyline\",{points:\"8 6 2 12 8 18\"})]}),\"Add-on Source Code\"]}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',gap:8,flexWrap:'wrap',marginBottom:16},children:fileNames.map(name=>/*#__PURE__*/_jsx(\"button\",{className:\"topbar-nav-btn \".concat(activeFile===name?'active':''),onClick:()=>setActiveFile(name),\"data-testid\":\"code-file-btn-\".concat(name.replace('.','-')),children:name},name))}),/*#__PURE__*/_jsxs(\"div\",{className:\"code-block\",\"data-testid\":\"code-block\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"code-block-header\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"code-block-filename\",children:activeFile}),/*#__PURE__*/_jsx(\"button\",{className:\"code-copy-btn\",onClick:copyCode,\"data-testid\":\"copy-code-btn\",children:copied?'Copied!':'Copy'})]}),/*#__PURE__*/_jsx(\"pre\",{style:{margin:0,whiteSpace:'pre-wrap',wordBreak:'break-word'},children:GS_FILES[activeFile]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"guide-section\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[/*#__PURE__*/_jsx(\"svg\",{width:\"20\",height:\"20\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"var(--google-blue)\",strokeWidth:\"2\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z\"})}),\"Backend Deployment\"]}),/*#__PURE__*/_jsxs(\"p\",{style:{fontSize:14,color:'var(--google-grey-700)',lineHeight:1.6},children:[\"The backend API needs to be deployed and accessible from Google Apps Script. Update the \",/*#__PURE__*/_jsx(\"code\",{children:\"API_BASE_URL\"}),\" in \",/*#__PURE__*/_jsx(\"code\",{children:\"ApiService.gs\"}),\" with your backend URL. The API handles RCA analysis using OpenAI GPT-4o and stores chat history in MongoDB.\"]})]})]})})});}export default InstallGuide;","map":{"version":3,"names":["React","useState","jsx","_jsx","jsxs","_jsxs","GS_FILES","InstallGuide","activeFile","setActiveFile","copied","setCopied","copyCode","textarea","document","createElement","value","style","position","opacity","body","appendChild","select","execCommand","removeChild","setTimeout","e","navigator","clipboard","writeText","then","err","console","warn","fileNames","Object","keys","className","children","maxWidth","marginBottom","color","width","height","viewBox","fill","stroke","strokeWidth","cx","cy","r","d","num","text","map","step","concat","points","display","gap","flexWrap","name","onClick","replace","margin","whiteSpace","wordBreak","fontSize","lineHeight"],"sources":["/app/frontend/src/components/InstallGuide.js"],"sourcesContent":["import React, { useState } from 'react';\n\nconst GS_FILES = {\n  'Code.gs': `/**\n * RCA Reviewer - Google Docs Add-on\n * Main entry point\n */\n\nfunction onOpen(e) {\n  DocumentApp.getUi()\n    .createAddonMenu()\n    .addItem('Open RCA Reviewer', 'showSidebar')\n    .addToUi();\n}\n\nfunction onInstall(e) {\n  onOpen(e);\n}\n\nfunction showSidebar() {\n  var html = HtmlService.createHtmlOutputFromFile('Sidebar')\n    .setTitle('RCA Reviewer')\n    .setWidth(360);\n  DocumentApp.getUi().showSidebar(html);\n}\n\n/**\n * Run the RCA review analysis\n */\nfunction runReview() {\n  var doc = DocumentApp.getActiveDocument();\n  var rcaTab = findOrCreateTab(doc, 'RCA');\n  \n  if (!rcaTab) {\n    return { error: 'RCA tab not found. Please create a tab named \"RCA\" with your content.' };\n  }\n  \n  var rcaBody = rcaTab.asDocumentTab().getBody();\n  var rcaText = rcaBody.getText();\n  \n  if (!rcaText.trim()) {\n    return { error: 'RCA tab is empty. Please write your RCA content first.' };\n  }\n  \n  // Get existing issue tracking\n  var props = PropertiesService.getDocumentProperties();\n  var existingIssues = JSON.parse(props.getProperty('rca_issues') || '[]');\n  \n  // Call backend API\n  var analysis = callBackendAPI('/api/analyze-rca', {\n    document_text: rcaText,\n    existing_issues: existingIssues\n  });\n  \n  if (analysis.error) {\n    return { error: analysis.error };\n  }\n  \n  // Insert inline comments in RCA tab\n  insertComments(doc, rcaBody, analysis.comments, existingIssues);\n  \n  // Create/update RCA Review tab\n  generateReviewTab(doc, analysis);\n  \n  // Store issue tracking\n  props.setProperty('rca_issues', JSON.stringify(analysis.comments));\n  props.setProperty('last_analysis', JSON.stringify(analysis));\n  \n  return analysis;\n}\n\n/**\n * Process a reply in a comment thread\n */\nfunction processReply(threadContext, userReply, issueType, originalComment) {\n  var result = callBackendAPI('/api/process-reply', {\n    thread_context: threadContext,\n    user_reply: userReply,\n    issue_type: issueType,\n    original_comment: originalComment\n  });\n  return result;\n}\n\n/**\n * Send a chat message\n */\nfunction sendChatMessage(message) {\n  var doc = DocumentApp.getActiveDocument();\n  var rcaTab = findOrCreateTab(doc, 'RCA');\n  var rcaText = rcaTab ? rcaTab.asDocumentTab().getBody().getText() : '';\n  \n  var props = PropertiesService.getDocumentProperties();\n  var sessionId = props.getProperty('chat_session_id') || '';\n  \n  var result = callBackendAPI('/api/chat', {\n    message: message,\n    document_context: rcaText,\n    session_id: sessionId\n  });\n  \n  if (result.session_id) {\n    props.setProperty('chat_session_id', result.session_id);\n  }\n  \n  return result;\n}`,\n\n  'DocumentService.gs': `/**\n * Document Tab management\n */\n\nfunction findOrCreateTab(doc, tabName) {\n  var tabs = doc.getTabs();\n  for (var i = 0; i < tabs.length; i++) {\n    if (tabs[i].getTitle() === tabName) {\n      return tabs[i];\n    }\n  }\n  return null;\n}\n\nfunction getOrCreateReviewTab(doc) {\n  var tab = findOrCreateTab(doc, 'RCA Review');\n  if (!tab) {\n    tab = doc.addTab('RCA Review');\n  }\n  return tab;\n}\n\nfunction generateReviewTab(doc, analysis) {\n  var tab = getOrCreateReviewTab(doc);\n  var body = tab.asDocumentTab().getBody();\n  \n  // Clear existing content\n  body.clear();\n  \n  var es = analysis.executive_summary;\n  var totalScore = analysis.total_score;\n  var timestamp = new Date().toLocaleString();\n  \n  // Header\n  var title = body.appendParagraph('RCA Reviewer -- Executive Summary');\n  title.setHeading(DocumentApp.ParagraphHeading.HEADING1);\n  title.setForegroundColor('#1a73e8');\n  \n  var subtitle = body.appendParagraph('Auto-generated. Updated on ' + timestamp + '.');\n  subtitle.setForegroundColor('#5f6368');\n  subtitle.setFontSize(10);\n  \n  body.appendParagraph('');\n  \n  // Section 1: Overall Assessment\n  var s1 = body.appendParagraph('Section 1: Overall Assessment');\n  s1.setHeading(DocumentApp.ParagraphHeading.HEADING2);\n  \n  body.appendParagraph('RCA Quality Score: ' + totalScore + ' / 30').setBold(true);\n  body.appendParagraph(es.overall_interpretation || '');\n  body.appendParagraph('');\n  \n  // Section 2: Leadership Summary\n  var s2 = body.appendParagraph('Section 2: Leadership Summary');\n  s2.setHeading(DocumentApp.ParagraphHeading.HEADING2);\n  \n  var bullets = es.leadership_bullets || [];\n  for (var i = 0; i < Math.min(bullets.length, 5); i++) {\n    body.appendListItem(bullets[i]).setGlyphType(DocumentApp.GlyphType.BULLET);\n  }\n  body.appendParagraph('');\n  \n  // Section 3: Key Gaps Identified\n  var s3 = body.appendParagraph('Section 3: Key Gaps Identified');\n  s3.setHeading(DocumentApp.ParagraphHeading.HEADING2);\n  \n  var gaps = es.key_gaps || [];\n  for (var i = 0; i < Math.min(gaps.length, 3); i++) {\n    body.appendListItem(gaps[i]).setGlyphType(DocumentApp.GlyphType.NUMBER);\n  }\n  body.appendParagraph('');\n  \n  // Section 4: Recurrence Risk\n  var s4 = body.appendParagraph('Section 4: Recurrence Risk');\n  s4.setHeading(DocumentApp.ParagraphHeading.HEADING2);\n  \n  body.appendParagraph(es.recurrence_risk || 'N/A').setBold(true);\n  body.appendParagraph(es.recurrence_rationale || '');\n  body.appendParagraph('');\n  \n  // Section 5: Action Items Critique\n  var s5 = body.appendParagraph('Section 5: Action Items Critique');\n  s5.setHeading(DocumentApp.ParagraphHeading.HEADING2);\n  \n  body.appendParagraph(es.action_critique || '');\n  body.appendParagraph('');\n  \n  // Section 6: What to Improve Next\n  var s6 = body.appendParagraph('Section 6: What to Improve Next');\n  s6.setHeading(DocumentApp.ParagraphHeading.HEADING2);\n  \n  var improvements = es.improvements || [];\n  for (var i = 0; i < improvements.length; i++) {\n    body.appendListItem(improvements[i]).setGlyphType(DocumentApp.GlyphType.BULLET);\n  }\n}`,\n\n  'CommentService.gs': `/**\n * Comment management for inline feedback\n */\n\nfunction insertComments(doc, rcaBody, comments, existingIssues) {\n  var existingMap = {};\n  for (var i = 0; i < existingIssues.length; i++) {\n    existingMap[existingIssues[i].issue_id] = existingIssues[i];\n  }\n  \n  for (var i = 0; i < comments.length; i++) {\n    var comment = comments[i];\n    \n    if (comment.resolved) {\n      // If issue is resolved, optionally mark it\n      continue;\n    }\n    \n    var anchorText = comment.anchor_text;\n    if (!anchorText) continue;\n    \n    // Find the text in the document\n    var searchResult = rcaBody.findText(escapeRegex(anchorText));\n    \n    if (searchResult) {\n      var element = searchResult.getElement();\n      var start = searchResult.getStartOffset();\n      var end = searchResult.getEndOffsetInclusive();\n      \n      // Highlight the text\n      if (element.editAsText) {\n        element.editAsText().setBackgroundColor(start, end, '#fce8b2');\n      }\n      \n      // Note: Google Docs API for comments requires Drive API\n      // In Apps Script, we use document-level comments via Drive\n      addDocumentComment(doc, comment);\n    }\n  }\n}\n\nfunction addDocumentComment(doc, comment) {\n  try {\n    var docId = doc.getId();\n    \n    // Use Drive API to add comments\n    // This requires the Drive API to be enabled\n    var resource = {\n      content: comment.comment_body,\n      anchor: comment.anchor_text\n    };\n    \n    // Store comment mapping for tracking\n    var props = PropertiesService.getDocumentProperties();\n    var commentMap = JSON.parse(props.getProperty('comment_map') || '{}');\n    commentMap[comment.issue_id] = {\n      issue_type: comment.issue_type,\n      anchor_text: comment.anchor_text,\n      comment_body: comment.comment_body,\n      timestamp: new Date().toISOString()\n    };\n    props.setProperty('comment_map', JSON.stringify(commentMap));\n    \n  } catch (e) {\n    Logger.log('Error adding comment: ' + e.toString());\n  }\n}\n\nfunction escapeRegex(str) {\n  return str.replace(/[.*+?^\\${}()|[\\\\]\\\\\\\\]/g, '\\\\\\\\$&');\n}`,\n\n  'ApiService.gs': `/**\n * Backend API communication\n */\n\nvar API_BASE_URL = 'YOUR_BACKEND_URL_HERE'; // Replace with your deployed backend URL\n\nfunction callBackendAPI(endpoint, payload) {\n  try {\n    var options = {\n      method: 'post',\n      contentType: 'application/json',\n      payload: JSON.stringify(payload),\n      muteHttpExceptions: true,\n      headers: {\n        'Accept': 'application/json'\n      }\n    };\n    \n    var response = UrlFetchApp.fetch(API_BASE_URL + endpoint, options);\n    var code = response.getResponseCode();\n    \n    if (code === 200) {\n      return JSON.parse(response.getContentText());\n    } else {\n      Logger.log('API error: ' + code + ' - ' + response.getContentText());\n      return { error: 'API request failed with status ' + code };\n    }\n    \n  } catch (e) {\n    Logger.log('API call failed: ' + e.toString());\n    return { error: 'Failed to connect to backend: ' + e.toString() };\n  }\n}`,\n\n  'appsscript.json': `{\n  \"timeZone\": \"America/New_York\",\n  \"dependencies\": {\n    \"enabledAdvancedServices\": [\n      {\n        \"userSymbol\": \"Drive\",\n        \"version\": \"v3\",\n        \"serviceId\": \"drive\"\n      }\n    ]\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"oauthScopes\": [\n    \"https://www.googleapis.com/auth/documents.currentonly\",\n    \"https://www.googleapis.com/auth/drive.file\",\n    \"https://www.googleapis.com/auth/script.external_request\",\n    \"https://www.googleapis.com/auth/script.container.ui\"\n  ]\n}`\n};\n\nfunction InstallGuide() {\n  const [activeFile, setActiveFile] = useState('Code.gs');\n  const [copied, setCopied] = useState(false);\n\n  const copyCode = () => {\n    try {\n      const textarea = document.createElement('textarea');\n      textarea.value = GS_FILES[activeFile];\n      textarea.style.position = 'fixed';\n      textarea.style.opacity = '0';\n      document.body.appendChild(textarea);\n      textarea.select();\n      document.execCommand('copy');\n      document.body.removeChild(textarea);\n      setCopied(true);\n      setTimeout(() => setCopied(false), 2000);\n    } catch (e) {\n      try {\n        navigator.clipboard.writeText(GS_FILES[activeFile]).then(() => {\n          setCopied(true);\n          setTimeout(() => setCopied(false), 2000);\n        });\n      } catch (err) {\n        console.warn('Copy failed:', err);\n      }\n    }\n  };\n\n  const fileNames = Object.keys(GS_FILES);\n\n  return (\n    <div className=\"doc-area\" data-testid=\"install-guide\">\n      <div className=\"doc-card\">\n        <div className=\"doc-body\" style={{ maxWidth: 800 }}>\n          <h2 style={{ marginBottom: 8 }}>Installation Guide</h2>\n          <p style={{ color: 'var(--google-grey-500)', marginBottom: 32 }}>\n            Set up the RCA Reviewer add-on in your Google Docs\n          </p>\n\n          <div className=\"guide-section\">\n            <h3>\n              <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"var(--google-blue)\" strokeWidth=\"2\">\n                <circle cx=\"12\" cy=\"12\" r=\"10\"/><path d=\"M12 6v6l4 2\"/>\n              </svg>\n              Setup Steps\n            </h3>\n\n            {[\n              { num: 1, text: 'Open your Google Doc and go to Extensions > Apps Script' },\n              { num: 2, text: 'Delete the default Code.gs content and replace with the code below' },\n              { num: 3, text: 'Create additional .gs files for each service (DocumentService, CommentService, ApiService)' },\n              { num: 4, text: 'Create a Sidebar.html file using the HTML template below' },\n              { num: 5, text: 'Update API_BASE_URL in ApiService.gs with your deployed backend URL' },\n              { num: 6, text: 'Update appsscript.json with the manifest content provided' },\n              { num: 7, text: 'Save and reload the Google Doc. The add-on will appear under Extensions menu.' },\n            ].map(step => (\n              <div key={step.num} className=\"guide-step\" data-testid={`guide-step-${step.num}`}>\n                <div className=\"guide-step-num\">{step.num}</div>\n                <div className=\"guide-step-content\">{step.text}</div>\n              </div>\n            ))}\n          </div>\n\n          <div className=\"guide-section\">\n            <h3>\n              <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"var(--google-blue)\" strokeWidth=\"2\">\n                <polyline points=\"16 18 22 12 16 6\"/><polyline points=\"8 6 2 12 8 18\"/>\n              </svg>\n              Add-on Source Code\n            </h3>\n\n            <div style={{ display: 'flex', gap: 8, flexWrap: 'wrap', marginBottom: 16 }}>\n              {fileNames.map(name => (\n                <button\n                  key={name}\n                  className={`topbar-nav-btn ${activeFile === name ? 'active' : ''}`}\n                  onClick={() => setActiveFile(name)}\n                  data-testid={`code-file-btn-${name.replace('.', '-')}`}\n                >\n                  {name}\n                </button>\n              ))}\n            </div>\n\n            <div className=\"code-block\" data-testid=\"code-block\">\n              <div className=\"code-block-header\">\n                <span className=\"code-block-filename\">{activeFile}</span>\n                <button className=\"code-copy-btn\" onClick={copyCode} data-testid=\"copy-code-btn\">\n                  {copied ? 'Copied!' : 'Copy'}\n                </button>\n              </div>\n              <pre style={{ margin: 0, whiteSpace: 'pre-wrap', wordBreak: 'break-word' }}>\n                {GS_FILES[activeFile]}\n              </pre>\n            </div>\n          </div>\n\n          <div className=\"guide-section\">\n            <h3>\n              <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"var(--google-blue)\" strokeWidth=\"2\">\n                <path d=\"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z\"/>\n              </svg>\n              Backend Deployment\n            </h3>\n            <p style={{ fontSize: 14, color: 'var(--google-grey-700)', lineHeight: 1.6 }}>\n              The backend API needs to be deployed and accessible from Google Apps Script. \n              Update the <code>API_BASE_URL</code> in <code>ApiService.gs</code> with your backend URL.\n              The API handles RCA analysis using OpenAI GPT-4o and stores chat history in MongoDB.\n            </p>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default InstallGuide;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,KAAQ,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAExC,KAAM,CAAAC,QAAQ,CAAG,CACf,SAAS,goFAuGT,CAEA,oBAAoB,+kGA+FpB,CAEA,mBAAmB,qkEAsEnB,CAEA,eAAe,k7BAgCf,CAEA,iBAAiB,okBAoBnB,CAAC,CAED,QAAS,CAAAC,YAAYA,CAAA,CAAG,CACtB,KAAM,CAACC,UAAU,CAAEC,aAAa,CAAC,CAAGR,QAAQ,CAAC,SAAS,CAAC,CACvD,KAAM,CAACS,MAAM,CAAEC,SAAS,CAAC,CAAGV,QAAQ,CAAC,KAAK,CAAC,CAE3C,KAAM,CAAAW,QAAQ,CAAGA,CAAA,GAAM,CACrB,GAAI,CACF,KAAM,CAAAC,QAAQ,CAAGC,QAAQ,CAACC,aAAa,CAAC,UAAU,CAAC,CACnDF,QAAQ,CAACG,KAAK,CAAGV,QAAQ,CAACE,UAAU,CAAC,CACrCK,QAAQ,CAACI,KAAK,CAACC,QAAQ,CAAG,OAAO,CACjCL,QAAQ,CAACI,KAAK,CAACE,OAAO,CAAG,GAAG,CAC5BL,QAAQ,CAACM,IAAI,CAACC,WAAW,CAACR,QAAQ,CAAC,CACnCA,QAAQ,CAACS,MAAM,CAAC,CAAC,CACjBR,QAAQ,CAACS,WAAW,CAAC,MAAM,CAAC,CAC5BT,QAAQ,CAACM,IAAI,CAACI,WAAW,CAACX,QAAQ,CAAC,CACnCF,SAAS,CAAC,IAAI,CAAC,CACfc,UAAU,CAAC,IAAMd,SAAS,CAAC,KAAK,CAAC,CAAE,IAAI,CAAC,CAC1C,CAAE,MAAOe,CAAC,CAAE,CACV,GAAI,CACFC,SAAS,CAACC,SAAS,CAACC,SAAS,CAACvB,QAAQ,CAACE,UAAU,CAAC,CAAC,CAACsB,IAAI,CAAC,IAAM,CAC7DnB,SAAS,CAAC,IAAI,CAAC,CACfc,UAAU,CAAC,IAAMd,SAAS,CAAC,KAAK,CAAC,CAAE,IAAI,CAAC,CAC1C,CAAC,CAAC,CACJ,CAAE,MAAOoB,GAAG,CAAE,CACZC,OAAO,CAACC,IAAI,CAAC,cAAc,CAAEF,GAAG,CAAC,CACnC,CACF,CACF,CAAC,CAED,KAAM,CAAAG,SAAS,CAAGC,MAAM,CAACC,IAAI,CAAC9B,QAAQ,CAAC,CAEvC,mBACEH,IAAA,QAAKkC,SAAS,CAAC,UAAU,CAAC,cAAY,eAAe,CAAAC,QAAA,cACnDnC,IAAA,QAAKkC,SAAS,CAAC,UAAU,CAAAC,QAAA,cACvBjC,KAAA,QAAKgC,SAAS,CAAC,UAAU,CAACpB,KAAK,CAAE,CAAEsB,QAAQ,CAAE,GAAI,CAAE,CAAAD,QAAA,eACjDnC,IAAA,OAAIc,KAAK,CAAE,CAAEuB,YAAY,CAAE,CAAE,CAAE,CAAAF,QAAA,CAAC,oBAAkB,CAAI,CAAC,cACvDnC,IAAA,MAAGc,KAAK,CAAE,CAAEwB,KAAK,CAAE,wBAAwB,CAAED,YAAY,CAAE,EAAG,CAAE,CAAAF,QAAA,CAAC,oDAEjE,CAAG,CAAC,cAEJjC,KAAA,QAAKgC,SAAS,CAAC,eAAe,CAAAC,QAAA,eAC5BjC,KAAA,OAAAiC,QAAA,eACEjC,KAAA,QAAKqC,KAAK,CAAC,IAAI,CAACC,MAAM,CAAC,IAAI,CAACC,OAAO,CAAC,WAAW,CAACC,IAAI,CAAC,MAAM,CAACC,MAAM,CAAC,oBAAoB,CAACC,WAAW,CAAC,GAAG,CAAAT,QAAA,eACrGnC,IAAA,WAAQ6C,EAAE,CAAC,IAAI,CAACC,EAAE,CAAC,IAAI,CAACC,CAAC,CAAC,IAAI,CAAC,CAAC,cAAA/C,IAAA,SAAMgD,CAAC,CAAC,aAAa,CAAC,CAAC,EACpD,CAAC,cAER,EAAI,CAAC,CAEJ,CACC,CAAEC,GAAG,CAAE,CAAC,CAAEC,IAAI,CAAE,yDAA0D,CAAC,CAC3E,CAAED,GAAG,CAAE,CAAC,CAAEC,IAAI,CAAE,oEAAqE,CAAC,CACtF,CAAED,GAAG,CAAE,CAAC,CAAEC,IAAI,CAAE,4FAA6F,CAAC,CAC9G,CAAED,GAAG,CAAE,CAAC,CAAEC,IAAI,CAAE,0DAA2D,CAAC,CAC5E,CAAED,GAAG,CAAE,CAAC,CAAEC,IAAI,CAAE,qEAAsE,CAAC,CACvF,CAAED,GAAG,CAAE,CAAC,CAAEC,IAAI,CAAE,2DAA4D,CAAC,CAC7E,CAAED,GAAG,CAAE,CAAC,CAAEC,IAAI,CAAE,+EAAgF,CAAC,CAClG,CAACC,GAAG,CAACC,IAAI,eACRlD,KAAA,QAAoBgC,SAAS,CAAC,YAAY,CAAC,4BAAAmB,MAAA,CAA2BD,IAAI,CAACH,GAAG,CAAG,CAAAd,QAAA,eAC/EnC,IAAA,QAAKkC,SAAS,CAAC,gBAAgB,CAAAC,QAAA,CAAEiB,IAAI,CAACH,GAAG,CAAM,CAAC,cAChDjD,IAAA,QAAKkC,SAAS,CAAC,oBAAoB,CAAAC,QAAA,CAAEiB,IAAI,CAACF,IAAI,CAAM,CAAC,GAF7CE,IAAI,CAACH,GAGV,CACN,CAAC,EACC,CAAC,cAEN/C,KAAA,QAAKgC,SAAS,CAAC,eAAe,CAAAC,QAAA,eAC5BjC,KAAA,OAAAiC,QAAA,eACEjC,KAAA,QAAKqC,KAAK,CAAC,IAAI,CAACC,MAAM,CAAC,IAAI,CAACC,OAAO,CAAC,WAAW,CAACC,IAAI,CAAC,MAAM,CAACC,MAAM,CAAC,oBAAoB,CAACC,WAAW,CAAC,GAAG,CAAAT,QAAA,eACrGnC,IAAA,aAAUsD,MAAM,CAAC,kBAAkB,CAAC,CAAC,cAAAtD,IAAA,aAAUsD,MAAM,CAAC,eAAe,CAAC,CAAC,EACpE,CAAC,qBAER,EAAI,CAAC,cAELtD,IAAA,QAAKc,KAAK,CAAE,CAAEyC,OAAO,CAAE,MAAM,CAAEC,GAAG,CAAE,CAAC,CAAEC,QAAQ,CAAE,MAAM,CAAEpB,YAAY,CAAE,EAAG,CAAE,CAAAF,QAAA,CACzEJ,SAAS,CAACoB,GAAG,CAACO,IAAI,eACjB1D,IAAA,WAEEkC,SAAS,mBAAAmB,MAAA,CAAoBhD,UAAU,GAAKqD,IAAI,CAAG,QAAQ,CAAG,EAAE,CAAG,CACnEC,OAAO,CAAEA,CAAA,GAAMrD,aAAa,CAACoD,IAAI,CAAE,CACnC,+BAAAL,MAAA,CAA8BK,IAAI,CAACE,OAAO,CAAC,GAAG,CAAE,GAAG,CAAC,CAAG,CAAAzB,QAAA,CAEtDuB,IAAI,EALAA,IAMC,CACT,CAAC,CACC,CAAC,cAENxD,KAAA,QAAKgC,SAAS,CAAC,YAAY,CAAC,cAAY,YAAY,CAAAC,QAAA,eAClDjC,KAAA,QAAKgC,SAAS,CAAC,mBAAmB,CAAAC,QAAA,eAChCnC,IAAA,SAAMkC,SAAS,CAAC,qBAAqB,CAAAC,QAAA,CAAE9B,UAAU,CAAO,CAAC,cACzDL,IAAA,WAAQkC,SAAS,CAAC,eAAe,CAACyB,OAAO,CAAElD,QAAS,CAAC,cAAY,eAAe,CAAA0B,QAAA,CAC7E5B,MAAM,CAAG,SAAS,CAAG,MAAM,CACtB,CAAC,EACN,CAAC,cACNP,IAAA,QAAKc,KAAK,CAAE,CAAE+C,MAAM,CAAE,CAAC,CAAEC,UAAU,CAAE,UAAU,CAAEC,SAAS,CAAE,YAAa,CAAE,CAAA5B,QAAA,CACxEhC,QAAQ,CAACE,UAAU,CAAC,CAClB,CAAC,EACH,CAAC,EACH,CAAC,cAENH,KAAA,QAAKgC,SAAS,CAAC,eAAe,CAAAC,QAAA,eAC5BjC,KAAA,OAAAiC,QAAA,eACEnC,IAAA,QAAKuC,KAAK,CAAC,IAAI,CAACC,MAAM,CAAC,IAAI,CAACC,OAAO,CAAC,WAAW,CAACC,IAAI,CAAC,MAAM,CAACC,MAAM,CAAC,oBAAoB,CAACC,WAAW,CAAC,GAAG,CAAAT,QAAA,cACrGnC,IAAA,SAAMgD,CAAC,CAAC,6CAA6C,CAAC,CAAC,CACpD,CAAC,qBAER,EAAI,CAAC,cACL9C,KAAA,MAAGY,KAAK,CAAE,CAAEkD,QAAQ,CAAE,EAAE,CAAE1B,KAAK,CAAE,wBAAwB,CAAE2B,UAAU,CAAE,GAAI,CAAE,CAAA9B,QAAA,EAAC,0FAEjE,cAAAnC,IAAA,SAAAmC,QAAA,CAAM,cAAY,CAAM,CAAC,OAAI,cAAAnC,IAAA,SAAAmC,QAAA,CAAM,eAAa,CAAM,CAAC,+GAEpE,EAAG,CAAC,EACD,CAAC,EACH,CAAC,CACH,CAAC,CACH,CAAC,CAEV,CAEA,cAAe,CAAA/B,YAAY","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}